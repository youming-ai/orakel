# Development Dockerfile for Web Dashboard
# Uses Node (not Bun) because Vite's http-proxy requires Node.js socket APIs

FROM node:22-alpine

WORKDIR /app

# Install bun for dependency resolution (respects bun.lock)
RUN npm i -g bun

# Install dependencies
COPY package.json bun.lock ./
RUN bun install --frozen-lockfile

# Copy source (will be mounted as volume in compose)
COPY . .

# Expose Vite dev server port
EXPOSE 9998

# Run Vite via Node â€” Bun lacks socket.destroySoon() needed by http-proxy
CMD ["npx", "vite", "--host", "0.0.0.0"]
